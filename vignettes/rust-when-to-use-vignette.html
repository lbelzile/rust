<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Paul Northrop" />

<meta name="date" content="2017-08-14" />

<title>When can rust be used?</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">When can rust be used?</h1>
<h4 class="author"><em>Paul Northrop</em></h4>
<h4 class="date"><em>2017-08-14</em></h4>


<div id="TOC">
<ul>
<li><a href="#conditions-on-fx">Conditions on <span class="math inline">\(f(x)\)</span></a></li>
<li><a href="#unbounded-densities">Unbounded densities</a></li>
<li><a href="#heavy-tailed-densities">Heavy-tailed densities</a><ul>
<li><a href="#cauchy-density">Cauchy density</a></li>
<li><a href="#hierarchical-1-way-anova-with-few-groups">Hierarchical 1-way ANOVA with few groups</a></li>
</ul></li>
<li><a href="#multimodal-densities">Multimodal densities</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<p>The generalized ratio-of-uniforms can be used to simulate from a wide range of <span class="math inline">\(d\)</span>-dimensional multivariate probability densities, provided that <span class="math inline">\(d\)</span> is not so large that its efficiency is prohibitively low (see the vignette <a href="rust-vignette.html">Introducing rust</a>). However, there are conditions that the target density <span class="math inline">\(f(x)\)</span> must satisfy for this method to be applicable. This vignette considers instances when these conditions do <em>not</em> hold and suggests strategies that may overcome this difficulty. Although the ratio-of-uniforms method can be used to simulate from multimodal densities, currently <strong>rust</strong> is designed to work effectively with unimodal densities. This vignette illustrates this using a simple 1-dimensional example.</p>
<div id="conditions-on-fx" class="section level2">
<h2>Conditions on <span class="math inline">\(f(x)\)</span></h2>
<p>The generalized ratio-of-uniforms method is an acceptance-rejection type of algorithm. It can only be applied to densities for which its acceptance region can be enclosed within a bounding region of finite volume from which it is simple to simulate, usually a cuboidal bounding box. For a <span class="math inline">\(d\)</span>-dimensional density <span class="math inline">\(f(x)\)</span> the bounding box (if it exists) is <span class="math inline">\((d+1)\)</span>-dimensional, given by <span class="math inline">\(\{ 0 &lt; u \leq a(r), \, b_i^-(r) \leq v_i \leq b_i^+(r), \, i = 1, \ldots, d \}\)</span> where <span class="math display">\[
\begin{eqnarray}
a(r) &amp;=&amp; \sup_\chi \, f(x)^{1 / (r d + 1)}, \\
b_i^-(r) &amp;=&amp; \inf_{\chi_i^-} \, x_i \, f(x)^{r / (r d + 1)}, \\  
b_i^+(r) &amp;=&amp; \sup_{\chi_i^+} \, x_i \, f(x)^{r / (r d + 1)},  
\end{eqnarray}
\]</span> <span class="math inline">\(x =(x_1, \ldots, x_d)\)</span> and <span class="math inline">\(\chi_i^- = \{ x \in \chi, x_i \leq 0 \}\)</span> and <span class="math inline">\(\chi_i^+ = \{ x \in \chi, x_i \geq 0 \}\)</span>. See the vignette <a href="rust-vignette.html">Introducing rust</a> for more details.</p>
<p>For a given value of the non-negative tuning parameter <span class="math inline">\(r\)</span> we need <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(x_i ^ {r d + 1} f(x) ^ r, i = 1, \ldots, d\)</span> to be bounded. If <span class="math inline">\(f(x)\)</span> is unbounded then we could use a transformation of variable to obtained a density that <em>is</em> bounded. For bounded <span class="math inline">\(f(x)\)</span> one or more of <span class="math inline">\(x_i ^ {r d + 1} f(x) ^ r, i = 1, \ldots, d\)</span> can be unbounded if <span class="math inline">\(f(x)\)</span> has heavy-tails. Again, we could use a transformation of variable to avoid this problem. For this issue the value of <span class="math inline">\(r\)</span> matters and we may be able to achieve boundedness is a sufficiently large value of <span class="math inline">\(r\)</span> is used. In <strong>rust</strong> <span class="math inline">\(r = 1/2\)</span> is used by default because this is optimal in the Gaussian case. For heavy-tailed densities <span class="math inline">\(r\)</span> needs to be larger, perhaps larger than 1. We consider these strategies in the next two sections.</p>
</div>
<div id="unbounded-densities" class="section level2">
<h2>Unbounded densities</h2>
<p>A simple example of an unbounded density is that of a gamma random variable with a shape parameter that is less than 1. Suppose that <span class="math inline">\(X \sim \mbox{gamma}(\alpha, 1)\)</span>. Then the density <span class="math inline">\(f_X(x)\)</span> increases without limit as <span class="math inline">\(x \rightarrow 0\)</span> from above. Let <span class="math inline">\(Y = (X^\lambda - 1) / \lambda\)</span>, that is a Box-Cox transformation <span class="citation">(Box and Cox 1964)</span> of <span class="math inline">\(X\)</span>. If we choose <span class="math inline">\(\lambda\)</span> appropriately then the density <span class="math inline">\(f_Y(y)\)</span> of <span class="math inline">\(Y\)</span> is bounded. <strong>rust</strong> has functions for selecting a suitable value of <span class="math inline">\(\lambda\)</span> in a somewhat automatic way (the user needs to specify a range of values (<code>min_phi</code>, <code>max_phi</code>) over which to perform the calculations). In the gamma(0.1, 1) case below a value of <span class="math inline">\(\lambda\)</span> that is close to 0 is suggested. The plots show that this does the trick.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rust)
alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>
max_phi &lt;-<span class="st"> </span><span class="kw">qgamma</span>(<span class="fl">0.999</span>, <span class="dt">shape =</span> alpha)
ptr_gam &lt;-<span class="st"> </span><span class="kw">create_xptr</span>(<span class="st">&quot;logdgamma&quot;</span>)
lambda &lt;-<span class="st"> </span><span class="kw">find_lambda_one_d_rcpp</span>(<span class="dt">logf =</span> ptr_gam, <span class="dt">alpha =</span> alpha,
                                 <span class="dt">max_phi =</span> max_phi)
<span class="co"># Box-Cox transformation parameter</span>
lambda$lambda
<span class="co">#&gt; [1] 0.06777767</span>
gam &lt;-<span class="st"> </span><span class="kw">ru_rcpp</span>(<span class="dt">logf =</span> ptr_gam, <span class="dt">alpha =</span> alpha, <span class="dt">d =</span> <span class="dv">1</span>, <span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">trans =</span> <span class="st">&quot;BC&quot;</span>,
             <span class="dt">lambda =</span> lambda)
<span class="kw">plot</span>(gam, <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>)
<span class="kw">plot</span>(gam, <span class="dt">ru_scale =</span> <span class="ot">TRUE</span>, <span class="dt">xlab =</span> <span class="st">&quot;y&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
</div>
<div id="heavy-tailed-densities" class="section level2">
<h2>Heavy-tailed densities</h2>
<p>Now we consider densities that are bounded but have sufficiently heavy tails that one or more of <span class="math inline">\(x_i ^ {r d + 1} f(x) ^ r, i = 1, \ldots, d\)</span> are unbounded if <span class="math inline">\(r = 1/2\)</span> is used.</p>
<div id="cauchy-density" class="section level3">
<h3>Cauchy density</h3>
<p>Suppose that <span class="math inline">\(X\)</span> has a standard Cauchy density, that is <span class="math inline">\(f(x) \propto (1 + x^2)^{-1}, -\infty &lt; x &lt; \infty\)</span>. The bounding box cannot be constructed if <span class="math inline">\(r &lt; 1\)</span>. For <span class="math inline">\(r = 1\)</span> the bounding box parameters <span class="math inline">\(b_1^-(r) = -1\)</span> and <span class="math inline">\(b_1^+(r) = 1\)</span> are attained in the limits as <span class="math inline">\(x\)</span> decreases/increases to infinity respectively. This is fine in theory but using <span class="math inline">\(r &gt; 1\)</span> avoids this problem and the largest probability of acceptance is obtained for <span class="math inline">\(r \approx 1.26\)</span>. We show the estimated bounding boxes and probabilities of acceptance for <span class="math inline">\(r = 1\)</span> and <span class="math inline">\(r = 1.26\)</span>. For <span class="math inline">\(r = 1\)</span> the algorithm find essentially the correct values even though these do not occur at a turning point of the objective functions. The estimated probability of acceptance is indeed larger for <span class="math inline">\(r = 1.26\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ptr_c &lt;-<span class="st"> </span><span class="kw">create_xptr</span>(<span class="st">&quot;logcauchy&quot;</span>)
cauchy1 &lt;-<span class="st"> </span><span class="kw">ru_rcpp</span>(<span class="dt">logf =</span> ptr_c, <span class="dt">log =</span> <span class="ot">TRUE</span>, <span class="dt">init =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">1</span>, <span class="dt">n =</span> <span class="dv">1000</span>)
cauchy126 &lt;-<span class="st"> </span><span class="kw">ru_rcpp</span>(<span class="dt">logf =</span> ptr_c, <span class="dt">log =</span> <span class="ot">TRUE</span>, <span class="dt">init =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="fl">1.26</span>, <span class="dt">n =</span> <span class="dv">1000</span>)
<span class="kw">cbind</span>(cauchy1$box, cauchy126$box)
<span class="co">#&gt;                box     vals1 conv        box     vals1 conv</span>
<span class="co">#&gt; a        1.0000000     0.000    0  1.0000000  0.000000    0</span>
<span class="co">#&gt; b1minus -0.9999999 -3136.747    0 -0.8310221 -2.948272    0</span>
<span class="co">#&gt; b1plus   0.9999999  3136.747    0  0.8310221  2.948272    0</span>
<span class="kw">c</span>(cauchy1$pa, cauchy126$pa)
<span class="co">#&gt; [1] 0.7923930 0.8496177</span></code></pre></div>
</div>
<div id="hierarchical-1-way-anova-with-few-groups" class="section level3">
<h3>Hierarchical 1-way ANOVA with few groups</h3>
Consider the hierarchical 1-way ANOVA model
<span class="math display">\[\begin{equation*}
Y_{ij} = \mu + \alpha_i + \epsilon_{ij}, \quad\mbox{for} \,\, i = 1, \ldots, I, \, 
j = 1, \ldots, n_i,  \label{eqn:1way}
\end{equation*}\]</span>
<p>where <span class="math inline">\(\alpha_i \sim N(0, \sigma_\alpha^2)\)</span> and <span class="math inline">\(\epsilon_{ij} \sim N(0, \sigma^2)\)</span> and all random variables are independent.</p>
<p>If the number <span class="math inline">\(I\)</span> of groups is small (in the example we consider below <span class="math inline">\(I = 4\)</span>) then there is little information about the parameter <span class="math inline">\(\sigma_\alpha\)</span> that summarises the variability in the mean of the response variable <span class="math inline">\(Y\)</span> across groups. Unless strong prior information about <span class="math inline">\(\sigma_\alpha\)</span> is provided the posterior distribution for <span class="math inline">\(\sigma_\alpha\)</span> will tend to have a heavy right tail <span class="citation">(Gelman 2006)</span>. Indeed, for a commonly-used `noninformative’ prior <span class="math inline">\(\pi(\mu, \sigma_\alpha, \log\sigma) \propto 1\)</span> <span class="citation">(Gelman et al. 2014)</span> a proper posterior density is not obtained if <span class="math inline">\(I &lt; 3\)</span> <span class="citation">(Gelman 2006)</span>.</p>
<p>To illustrate the problem that a heavy-tailed desnity can cause a naive implementation of the generalized ratio-of-uniforms algorithm we use the blood coagulation time data presented in Table 11.2 of <span class="citation">Gelman et al. (2014)</span>. These data are available as the dataframe <code>coagulation</code> in the <strong>bang</strong> package <span class="citation">(Northrop and Hall 2017)</span>: the first column holds the response values (the coagulation times of blood drawn from 24 animals), the second column a factor indicating which of 4 diets the animal is allocated.</p>
<p>The <strong>bang</strong> function <code>hanova1</code> uses the generalized ratio-of-uniforms method to sample from the marginal posterior distribution of <span class="math inline">\((\mu, \sigma_\alpha, \sigma)\)</span> given data based on a user-supplied prior distribution. The default prior is <span class="math inline">\(\pi(\mu, \sigma_\alpha, \log\sigma) \propto 1\)</span>. By default (argument <code>param = &quot;trans&quot;</code>) <code>hanova1</code> parametizes the marginal posterior in terms of <span class="math inline">\((\mu, \log \sigma_\alpha, \log \sigma)\)</span>. If instead we use <code>param = &quot;original&quot;</code>, so that this posterior is parameterized in terms of <span class="math inline">\((\mu, \sigma_\alpha, \sigma)\)</span>, then, with the default <span class="math inline">\(r = 1/2\)</span>, we find that the bounding box cannot be found because the right tail of the posterior for <span class="math inline">\(\sigma_\alpha\)</span> is heavy enough to prevent this. However, if we use <span class="math inline">\(r = 1\)</span> then the bounding box can be found.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bang)
coag1 &lt;-<span class="st"> </span><span class="kw">hanova1</span>(<span class="dt">resp =</span> coagulation[, <span class="dv">1</span>], <span class="dt">fac =</span> coagulation[, <span class="dv">2</span>], <span class="dt">n =</span> <span class="dv">10000</span>)
coag2 &lt;-<span class="st"> </span><span class="kw">hanova1</span>(<span class="dt">resp =</span> coagulation[, <span class="dv">1</span>], <span class="dt">fac =</span> coagulation[, <span class="dv">2</span>], <span class="dt">n =</span> <span class="dv">10000</span>,
                 <span class="dt">param =</span> <span class="st">&quot;original&quot;</span>, <span class="dt">r =</span> <span class="dv">1</span>)
probs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.5</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="fl">97.5</span>) /<span class="st"> </span><span class="dv">100</span>
all1 &lt;-<span class="st"> </span><span class="kw">cbind</span>(coag1$theta_sim_vals, coag1$sim_vals)
all2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(coag2$theta_sim_vals, coag2$sim_vals)
<span class="kw">round</span>(<span class="kw">t</span>(<span class="kw">apply</span>(all1, <span class="dv">2</span>, quantile, <span class="dt">probs =</span> probs)), <span class="dv">1</span>)
<span class="co">#&gt;              2.5%  25%  50%  75% 97.5%</span>
<span class="co">#&gt; theta[1]     58.8 60.4 61.2 62.1  63.7</span>
<span class="co">#&gt; theta[2]     63.9 65.2 65.9 66.5  67.9</span>
<span class="co">#&gt; theta[3]     65.7 67.1 67.8 68.4  69.7</span>
<span class="co">#&gt; theta[4]     59.4 60.6 61.1 61.7  62.9</span>
<span class="co">#&gt; mu           54.8 62.2 64.0 65.7  73.1</span>
<span class="co">#&gt; sigma[alpha]  2.0  3.5  5.1  8.0  26.6</span>
<span class="co">#&gt; sigma         1.8  2.2  2.4  2.7   3.4</span>
<span class="kw">round</span>(<span class="kw">t</span>(<span class="kw">apply</span>(all2, <span class="dv">2</span>, quantile, <span class="dt">probs =</span> probs)), <span class="dv">1</span>)
<span class="co">#&gt;              2.5%  25%  50%  75% 97.5%</span>
<span class="co">#&gt; theta[1]     58.8 60.4 61.2 62.1  63.7</span>
<span class="co">#&gt; theta[2]     63.9 65.2 65.9 66.5  67.9</span>
<span class="co">#&gt; theta[3]     65.7 67.1 67.8 68.5  69.8</span>
<span class="co">#&gt; theta[4]     59.5 60.6 61.2 61.7  62.9</span>
<span class="co">#&gt; mu           55.1 62.3 64.0 65.8  73.4</span>
<span class="co">#&gt; sigma[alpha]  2.0  3.5  5.1  7.9  26.7</span>
<span class="co">#&gt; sigma         1.8  2.2  2.4  2.7   3.4</span></code></pre></div>
<p>These posterior summaries are similar to those presented in Table 11.3 of <span class="citation">Gelman et al. (2014)</span> (where <span class="math inline">\(\sigma_\alpha\)</span> is denoted <span class="math inline">\(\tau\)</span>), which were obtained using Gibbs sampling.</p>
</div>
</div>
<div id="multimodal-densities" class="section level2">
<h2>Multimodal densities</h2>
<p>unimodal/bimodal</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ptr_mix &lt;-<span class="st"> </span><span class="kw">create_xptr</span>(<span class="st">&quot;lognormalmix&quot;</span>)
res &lt;-<span class="st"> </span><span class="kw">ru_rcpp</span>(<span class="dt">logf =</span> ptr_mix, <span class="dt">mu =</span> <span class="dv">10</span>, <span class="dt">p =</span> <span class="fl">0.25</span>, <span class="dt">init =</span> <span class="fl">0.1</span>, <span class="dt">n =</span> <span class="dv">10000</span>)
<span class="kw">plot</span>(res)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res &lt;-<span class="st"> </span><span class="kw">ru_rcpp</span>(<span class="dt">logf =</span> ptr_mix, <span class="dt">mu =</span> <span class="dv">4</span>, <span class="dt">p =</span> <span class="fl">0.25</span>, <span class="dt">init =</span> <span class="dv">5</span>, <span class="dt">n =</span> <span class="dv">10000</span>)
<span class="kw">plot</span>(res)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script>
<div id="refs" class="references">
<div id="ref-BC1964">
<p>Box, G. E. P., and D. R. Cox. 1964. “An Analysis of Transformations.” <em>Journal of the Royal Statistical Society. Series B (Methodological)</em> 26 (2). Wiley for the Royal Statistical Society: 211–52. <a href="http://www.jstor.org/stable/2984418" class="uri">http://www.jstor.org/stable/2984418</a>.</p>
</div>
<div id="ref-Gelman2006">
<p>Gelman, A. 2006. “Prior Distributions for Variance Parameters in Hierarchical Models.” <em>Bayesian Analysis</em> 1 (3): 515–33. <a href="https://doi.org/10.1214/06-BA117A" class="uri">https://doi.org/10.1214/06-BA117A</a>.</p>
</div>
<div id="ref-BDA2014">
<p>Gelman, A., J. B. Carlin, H. S. Stern, D. B. Dunson, A. Vehtari, and D. B. Rubin. 2014. <em>Bayesian Data Analysis</em>. Third. Florida, USA: Chapman &amp; Hall / CRC. <a href="http://www.stat.columbia.edu/~gelman/book/" class="uri">http://www.stat.columbia.edu/~gelman/book/</a>.</p>
</div>
<div id="ref-bang">
<p>Northrop, Paul J., and Benjamin D. Hall. 2017. <em>Bang: Bayesian Analysis, No Gibbs</em>. <a href="http://github.com/paulnorthrop/bang" class="uri">http://github.com/paulnorthrop/bang</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
